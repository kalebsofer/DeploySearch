Inference and UI live here. 